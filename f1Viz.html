<html>

	<head>
		<link rel="shortcut icon" href="#">
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
		<!-- we want to use D3, so this is where the D3 library version 7 gets called-->
		<script src="https://d3js.org/d3.v7.min.js"></script>
		
		<!-- title of the webpage -->
		<title> CS5044 Practical 2 - F1 Lap Analysis </title>
		
		<!-- for css -->
		<style> 
			body{
				font-family: sans-serif;
			}
			p {
				color: grey;
			}
		</style>
		
	</head>

	<body>
	
		<!-- simple text heading-->
		<h2>CS5044 Practical 2 - F1 Lap Analysis</h2>
		
		<!-- start of JavaScript code -->
		<script> 
		let datapath = "data/LEC_Bahrain_Lap_Number56_Telemetry_Data.csv";

		let width = 1000;					//specifies the width, height and margins of our SVG element
		let height = 600;
		let margin = 100;
		let xMid = width / 2;
		let yMid = height / 2;

		d3.csv(datapath)
		    .then(function(myData){
				console.log(myData);

				let svg = d3.select("body")		//creates an SVG element in the body
							.append("svg")
							.attr("width", width + margin)
							.attr("height", height + margin);
				
				//convert X and Y attributes back to integers
				myData.forEach(function(d) {
					d.X = +d.X;
					d.Y = +d.Y;
				});

				let xMax = d3.max(myData, (d) => d.X);
				let yMax = d3.max(myData, (d) => d.Y);
				let speedMax = d3.max(myData, (d) => parseInt(d.Speed));
				const colorScale = d3.scaleLinear()
										.domain([0, speedMax])
										.range(['yellow','red']);
				
				console.log(colorScale(speedMax));

				d3.select("svg")
				      .selectAll("circle")
					  .data(myData)
					  .enter().append("circle")
                      .style("fill", (d) => colorScale(d.Speed))
						   .attr("cx", function(d){
							    return xMid + xMid * (d.X / xMax);   
						   })
						   .attr("cy", function(d){
							    return yMid + yMid * (d.Y / yMax);
						   })
						   .attr("r", 2);
			});

		</script>
		
	
	</body>

</html>